<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢—Ä–µ–Ω–∞–∂–µ—Ä –∏–Ω–≥–∏–±–∏—Ç–æ—Ä–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            padding: 20px;
        }
        
        .container {
            width: 100%;
            max-width: 800px;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(90deg, #2c3e50, #4a6491);
            color: white;
            padding: 20px;
            text-align: center;
        }
        
        h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
        }
        
        .instructions {
            background-color: #f8f9fa;
            padding: 20px;
            border-bottom: 1px solid #dee2e6;
        }
        
        .instructions h2 {
            color: #2c3e50;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .instructions ul {
            list-style-type: none;
            padding-left: 10px;
        }
        
        .instructions li {
            margin-bottom: 10px;
            padding-left: 30px;
            position: relative;
        }
        
        .instructions li:before {
            content: "‚Ä¢";
            color: #3498db;
            font-size: 1.5rem;
            position: absolute;
            left: 0;
            top: -5px;
        }
        
        .game-area {
            padding: 30px;
            text-align: center;
        }
        
        .shape-container {
            width: 200px;
            height: 200px;
            margin: 0 auto 30px;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            border: 3px dashed #bdc3c7;
            border-radius: 15px;
        }
        
        .shape {
            width: 150px;
            height: 150px;
            opacity: 0;
            transition: opacity 0.2s;
            position: absolute;
        }
        
        .square {
            background-color: #3498db;
            border-radius: 10px;
        }
        
        .circle {
            background-color: #e74c3c;
            border-radius: 50%;
        }
        
        .visible {
            opacity: 1;
        }
        
        .stop-signal {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 1.5rem;
            font-weight: bold;
            color: #c0392b;
            opacity: 0;
            transition: opacity 0.2s;
            background: rgba(255, 255, 255, 0.9);
            padding: 10px 20px;
            border-radius: 10px;
            border: 3px solid #c0392b;
        }
        
        .stop-signal.visible {
            opacity: 1;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        button {
            padding: 12px 25px;
            font-size: 1.1rem;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        #startBtn {
            background: linear-gradient(90deg, #2ecc71, #1abc9c);
            color: white;
        }
        
        #startBtn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(46, 204, 113, 0.4);
        }
        
        #resetBtn {
            background: linear-gradient(90deg, #e74c3c, #c0392b);
            color: white;
        }
        
        #resetBtn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(231, 76, 60, 0.4);
        }

        #retryBtn {
            background: linear-gradient(90deg, #3498db, #2980b9);
            color: white;
            margin-top: 15px;
        }
        
        #retryBtn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
        }
        
        button:disabled {
            background: #95a5a6;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .stat-item {
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            text-align: center;
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #2c3e50;
            margin-top: 5px;
        }
        
        .progress-container {
            margin-bottom: 20px;
        }
        
        .progress-bar {
            height: 20px;
            background-color: #ecf0f1;
            border-radius: 10px;
            overflow: hidden;
        }
        
        .progress {
            height: 100%;
            background: linear-gradient(90deg, #3498db, #2ecc71);
            width: 0%;
            transition: width 0.5s;
        }
        
        .key-hint {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 20px;
        }
        
        .key {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }
        
        .key-box {
            width: 70px;
            height: 70px;
            background: linear-gradient(135deg, #34495e, #2c3e50);
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.8rem;
            font-weight: bold;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .key-buttons {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin: 20px 0;
        }
        
        .key-btn {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: bold;
            border-radius: 10px;
            cursor: pointer;
            user-select: none;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .key-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 7px 20px rgba(0, 0, 0, 0.3);
        }
        
        .results {
            background-color: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            margin-top: 20px;
            display: none;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .results h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .result-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }
        
        .result-item {
            background: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }
        
        .result-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: #2c3e50;
            margin-top: 5px;
        }
        
        .good {
            color: #27ae60;
        }
        
        .bad {
            color: #e74c3c;
        }
        
        .feedback {
            margin-top: 20px;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            font-weight: bold;
            display: none;
        }
        
        .positive {
            background-color: #d5f4e6;
            color: #27ae60;
        }
        
        .negative {
            background-color: #fadbd8;
            color: #e74c3c;
        }
        
        .focus-warning {
            background-color: #fff3cd;
            color: #856404;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            display: none;
        }

        .retry-container {
            text-align: center;
            margin-top: 20px;
        }
        
        @media (max-width: 600px) {
            .stats, .result-stats {
                grid-template-columns: 1fr;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
            }
            
            button {
                width: 80%;
            }
            
            .key-hint, .key-buttons {
                flex-direction: column;
                gap: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>–¢—Ä–µ–Ω–∞–∂–µ—Ä –∏–Ω–≥–∏–±–∏—Ç–æ—Ä–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è</h1>
            <p>–¢—Ä–µ–Ω–∏—Ä—É–π—Ç–µ —Å–∫–æ—Ä–æ—Å—Ç—å —Ä–µ–∞–∫—Ü–∏–∏ –∏ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –∫ —Å–∞–º–æ–∫–æ–Ω—Ç—Ä–æ–ª—é</p>
        </header>
        
        <div class="instructions">
            <h2>üìã –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è</h2>
            <ul>
                <li>–ö–æ–≥–¥–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è <strong>–∫–≤–∞–¥—Ä–∞—Ç</strong>, –Ω–∞–∂–º–∏—Ç–µ –∫–ª–∞–≤–∏—à—É <strong>X</strong> –∏–ª–∏ –∫–Ω–æ–ø–∫—É X</li>
                <li>–ö–æ–≥–¥–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è <strong>–∫—Ä—É–≥</strong>, –Ω–∞–∂–º–∏—Ç–µ –∫–ª–∞–≤–∏—à—É <strong>M</strong> –∏–ª–∏ –∫–Ω–æ–ø–∫—É M</li>
                <li>–ï—Å–ª–∏ –ø–æ—Å–ª–µ –ø–æ—è–≤–ª–µ–Ω–∏—è —Ñ–∏–≥—É—Ä—ã —Ä–∞–∑–¥–∞–µ—Ç—Å—è <strong>–∑–≤—É–∫–æ–≤–æ–π —Å–∏–≥–Ω–∞–ª</strong>, –ù–ï –Ω–∞–∂–∏–º–∞–π—Ç–µ –∫–Ω–æ–ø–∫—É</li>
                <li>–°—Ç–∞—Ä–∞–π—Ç–µ—Å—å —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∫ –º–æ–∂–Ω–æ <strong>–±—ã—Å—Ç—Ä–µ–µ</strong>, –Ω–æ –Ω–µ –æ—à–∏–±–∞—Ç—å—Å—è</li>
                <li>–ò–≥—Ä–∞ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ <strong>20 –ø–æ–ø—ã—Ç–æ–∫</strong></li>
            </ul>
        </div>
        
        <div class="game-area">
            <div class="focus-warning" id="focusWarning">
                ‚ö†Ô∏è –î–ª—è —Ä–∞–±–æ—Ç—ã –∏–≥—Ä—ã —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤ —Ñ–æ–∫—É—Å–µ. –ù–∞–∂–º–∏—Ç–µ –≤ –ª—é–±–æ–º –º–µ—Å—Ç–µ –∏–≥—Ä—ã.
            </div>
            
            <div class="shape-container">
                <div class="shape square" id="square"></div>
                <div class="shape circle" id="circle"></div>
                <div class="stop-signal" id="stopSignal">–°–¢–û–ü!</div>
            </div>
            
            <div class="key-buttons">
                <div class="key-btn" id="xBtn">X</div>
                <div class="key-btn" id="mBtn">M</div>
            </div>
            
            <div class="controls">
                <button id="startBtn">
                    <span>üéÆ</span> –ù–∞—á–∞—Ç—å –∏–≥—Ä—É
                </button>
                <button id="resetBtn" disabled>
                    <span>üîÑ</span> –°–±—Ä–æ—Å–∏—Ç—å
                </button>
            </div>
            
            <div class="progress-container">
                <div class="progress-bar">
                    <div class="progress" id="progress"></div>
                </div>
                <div id="progressText">–ü—Ä–æ–≥—Ä–µ—Å—Å: 0/20</div>
            </div>
            
            <div class="stats">
                <div class="stat-item">
                    <div>–ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ä–µ–∞–∫—Ü–∏–∏</div>
                    <div class="stat-value" id="correct">0</div>
                </div>
                <div class="stat-item">
                    <div>–û—à–∏–±–∫–∏</div>
                    <div class="stat-value" id="errors">0</div>
                </div>
                <div class="stat-item">
                    <div>–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è</div>
                    <div class="stat-value" id="avgTime">0 –º—Å</div>
                </div>
                <div class="stat-item">
                    <div>–£—Å–ø–µ—à–Ω–æ–µ —Ç–æ—Ä–º–æ–∂–µ–Ω–∏–µ</div>
                    <div class="stat-value" id="inhibition">0%</div>
                </div>
            </div>
            
            <div class="key-hint">
                <div class="key">
                    <div class="key-box">X</div>
                    <div>–î–ª—è –∫–≤–∞–¥—Ä–∞—Ç–∞</div>
                </div>
                <div class="key">
                    <div class="key-box">M</div>
                    <div>–î–ª—è –∫—Ä—É–≥–∞</div>
                </div>
            </div>
            
            <div class="feedback" id="feedback"></div>
            
            <div class="results" id="results">
                <h2>üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã üéâ</h2>
                <div class="result-stats">
                    <div class="result-item">
                        <div>–ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ä–µ–∞–∫—Ü–∏–∏</div>
                        <div class="result-value good" id="finalCorrect">0</div>
                    </div>
                    <div class="result-item">
                        <div>–û—à–∏–±–∫–∏</div>
                        <div class="result-value bad" id="finalErrors">0</div>
                    </div>
                    <div class="result-item">
                        <div>–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è</div>
                        <div class="result-value" id="finalAvgTime">0 –º—Å</div>
                    </div>
                    <div class="result-item">
                        <div>–£—Å–ø–µ—à–Ω–æ–µ —Ç–æ—Ä–º–æ–∂–µ–Ω–∏–µ</div>
                        <div class="result-value good" id="finalInhibition">0%</div>
                    </div>
                </div>
                <div class="retry-container">
                    <button id="retryBtn">
                        <span>üîÑ</span> –ü–µ—Ä–µ–ø—Ä–æ–π—Ç–∏ —Ç–µ—Å—Ç
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
            const startBtn = document.getElementById('startBtn');
            const resetBtn = document.getElementById('resetBtn');
            const retryBtn = document.getElementById('retryBtn');
            const square = document.getElementById('square');
            const circle = document.getElementById('circle');
            const stopSignal = document.getElementById('stopSignal');
            const progress = document.getElementById('progress');
            const progressText = document.getElementById('progressText');
            const correctEl = document.getElementById('correct');
            const errorsEl = document.getElementById('errors');
            const avgTimeEl = document.getElementById('avgTime');
            const inhibitionEl = document.getElementById('inhibition');
            const resultsEl = document.getElementById('results');
            const finalCorrectEl = document.getElementById('finalCorrect');
            const finalErrorsEl = document.getElementById('finalErrors');
            const finalAvgTimeEl = document.getElementById('finalAvgTime');
            const finalInhibitionEl = document.getElementById('finalInhibition');
            const feedbackEl = document.getElementById('feedback');
            const focusWarning = document.getElementById('focusWarning');
            const xBtn = document.getElementById('xBtn');
            const mBtn = document.getElementById('mBtn');
            
            // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–≥—Ä—ã
            let gameActive = false;
            let currentShape = null;
            let startTime = 0;
            let stopSignalActive = false;
            let attempts = 0;
            let correctCount = 0;
            let errorCount = 0;
            let totalTime = 0;
            let inhibitionAttempts = 0;
            let successfulInhibitions = 0;
            let audioContext = null;

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ–∫—É—Å–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            window.addEventListener('focus', function() {
                focusWarning.style.display = 'none';
            });

            window.addEventListener('blur', function() {
                if (gameActive) {
                    focusWarning.style.display = 'block';
                }
            });

            // –ê–∫—Ç–∏–≤–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø–æ –∫–ª–∏–∫—É
            document.addEventListener('click', function() {
                if (audioContext && audioContext.state === 'suspended') {
                    audioContext.resume();
                }
                focusWarning.style.display = 'none';
            });

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫
            xBtn.addEventListener('click', function() {
                if (gameActive && currentShape) {
                    handleResponse('square');
                }
            });

            mBtn.addEventListener('click', function() {
                if (gameActive && currentShape) {
                    handleResponse('circle');
                }
            });

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–ü–µ—Ä–µ–ø—Ä–æ–π—Ç–∏ —Ç–µ—Å—Ç"
            retryBtn.addEventListener('click', function() {
                window.location.href = 'index.html';
            });
            
            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∞—É–¥–∏–æ
            function initAudio() {
                if (!audioContext) {
                    audioContext = new (window.AudioContext || window.webkitAudioContext)();
                }
                if (audioContext.state === 'suspended') {
                    audioContext.resume();
                }
            }
            
            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –∑–≤—É–∫–∞
            function playBeep(frequency, duration) {
                initAudio();
                
                try {
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    oscillator.frequency.value = frequency;
                    oscillator.type = 'sine';
                    
                    gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration);
                    
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + duration);
                } catch (e) {
                    console.log('Audio error:', e);
                }
            }
            
            // –§—É–Ω–∫—Ü–∏—è –Ω–∞—á–∞–ª–∞ –∏–≥—Ä—ã
            function startGame() {
                initAudio();
                gameActive = true;
                startBtn.disabled = true;
                resetBtn.disabled = false;
                attempts = 0;
                correctCount = 0;
                errorCount = 0;
                totalTime = 0;
                inhibitionAttempts = 0;
                successfulInhibitions = 0;
                updateStats();
                resultsEl.style.display = 'none';
                feedbackEl.style.display = 'none';
                focusWarning.style.display = 'none';
                nextTrial();
            }
            
            // –§—É–Ω–∫—Ü–∏—è —Å–±—Ä–æ—Å–∞ –∏–≥—Ä—ã
            function resetGame() {
                gameActive = false;
                startBtn.disabled = false;
                resetBtn.disabled = true;
                square.classList.remove('visible');
                circle.classList.remove('visible');
                stopSignal.classList.remove('visible');
                resultsEl.style.display = 'none';
                progress.style.width = '0%';
                progressText.textContent = '–ü—Ä–æ–≥—Ä–µ—Å—Å: 0/20';
                focusWarning.style.display = 'none';
            }
            
            // –°–ª–µ–¥—É—é—â–µ–µ –∏—Å–ø—ã—Ç–∞–Ω–∏–µ
            function nextTrial() {
                if (!gameActive || attempts >= 20) {
                    endGame();
                    return;
                }
                
                attempts++;
                updateStats();
                progress.style.width = `${(attempts / 20) * 100}%`;
                progressText.textContent = `–ü—Ä–æ–≥—Ä–µ—Å—Å: ${attempts}/20`;
                
                // –°–∫—Ä—ã–≤–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â—É—é —Ñ–∏–≥—É—Ä—É –∏ —Å—Ç–æ–ø-—Å–∏–≥–Ω–∞–ª
                square.classList.remove('visible');
                circle.classList.remove('visible');
                stopSignal.classList.remove('visible');
                stopSignalActive = false;
                feedbackEl.style.display = 'none';
                
                // –°–ª—É—á–∞–π–Ω—ã–π –≤—ã–±–æ—Ä —Ñ–∏–≥—É—Ä—ã (–∫–≤–∞–¥—Ä–∞—Ç –∏–ª–∏ –∫—Ä—É–≥)
                const shapeType = Math.random() > 0.5 ? 'square' : 'circle';
                currentShape = shapeType;
                
                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º, –±—É–¥–µ—Ç –ª–∏ —Å—Ç–æ–ø-—Å–∏–≥–Ω–∞–ª (30% —Å–ª—É—á–∞–µ–≤)
                const willStop = Math.random() < 0.3;
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–∏–≥—É—Ä—É —á–µ—Ä–µ–∑ —Å–ª—É—á–∞–π–Ω—É—é –∑–∞–¥–µ—Ä–∂–∫—É (1-2 —Å–µ–∫—É–Ω–¥—ã)
                setTimeout(() => {
                    if (!gameActive) return;
                    
                    document.getElementById(shapeType).classList.add('visible');
                    startTime = Date.now();
                    
                    // –ï—Å–ª–∏ –µ—Å—Ç—å —Å—Ç–æ–ø-—Å–∏–≥–Ω–∞–ª, –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º –µ–≥–æ —á–µ—Ä–µ–∑ —Å–ª—É—á–∞–π–Ω–æ–µ –≤—Ä–µ–º—è (100-300 –º—Å)
                    if (willStop) {
                        inhibitionAttempts++;
                        const stopDelay = 100 + Math.random() * 200;
                        setTimeout(() => {
                            if (gameActive && document.getElementById(shapeType).classList.contains('visible')) {
                                stopSignalActive = true;
                                stopSignal.classList.add('visible');
                                playBeep(800, 0.5);
                            }
                        }, stopDelay);
                    }
                    
                    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –∏—Å–ø—ã—Ç–∞–Ω–∏—é —á–µ—Ä–µ–∑ 1.5 —Å–µ–∫—É–Ω–¥—ã, –µ—Å–ª–∏ –Ω–µ –±—ã–ª–æ —Ä–µ–∞–∫—Ü–∏–∏
                    setTimeout(() => {
                        if (gameActive && document.getElementById(shapeType).classList.contains('visible')) {
                            // –ï—Å–ª–∏ —Ñ–∏–≥—É—Ä–∞ –≤—Å–µ –µ—â–µ –≤–∏–¥–Ω–∞, –∑–Ω–∞—á–∏—Ç —Ä–µ–∞–∫—Ü–∏–∏ –Ω–µ –±—ã–ª–æ
                            if (!willStop) {
                                // –ï—Å–ª–∏ –Ω–µ –±—ã–ª–æ —Å—Ç–æ–ø-—Å–∏–≥–Ω–∞–ª–∞, —ç—Ç–æ –æ—à–∏–±–∫–∞
                                errorCount++;
                                showFeedback("–í—Ä–µ–º—è –≤—ã—à–ª–æ! –ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–∂–∞—Ç—å –∫–ª–∞–≤–∏—à—É", false);
                                updateStats();
                            } else {
                                // –ï—Å–ª–∏ –±—ã–ª —Å—Ç–æ–ø-—Å–∏–≥–Ω–∞–ª –∏ —Ä–µ–∞–∫—Ü–∏–∏ –Ω–µ –±—ã–ª–æ, —ç—Ç–æ —É—Å–ø–µ—à–Ω–æ–µ —Ç–æ—Ä–º–æ–∂–µ–Ω–∏–µ
                                successfulInhibitions++;
                                showFeedback("–ü—Ä–∞–≤–∏–ª—å–Ω–æ! –í—ã –ø–æ–¥–∞–≤–∏–ª–∏ —Ä–µ–∞–∫—Ü–∏—é", true);
                            }
                            setTimeout(nextTrial, 1000);
                        }
                    }, 1500);
                    
                }, 1000 + Math.random() * 1000);
            }
            
            // –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏—è –∫–ª–∞–≤–∏—à
            document.addEventListener('keydown', function(event) {
                if (!gameActive || !currentShape) return;
                
                console.log('Key pressed:', event.key, 'Key code:', event.keyCode, 'Code:', event.code);
                
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º event.code –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å —Ä–∞–∑–Ω—ã–º–∏ —Ä–∞—Å–∫–ª–∞–¥–∫–∞–º–∏
                // X key: English 'x', Russian '—á' (Cyrillic)
                // M key: English 'm', Russian '—å' (Cyrillic)
                
                if (event.code === 'KeyX' || event.key.toLowerCase() === 'x' || event.key.toLowerCase() === '—Ö' || event.key.toLowerCase() === '—á') {
                    handleResponse('square');
                } else if (event.code === 'KeyM' || event.key.toLowerCase() === 'm' || event.key.toLowerCase() === '–º' || event.key.toLowerCase() === '—å') {
                    handleResponse('circle');
                }
            });
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            function handleResponse(expectedShape) {
                if (!gameActive) return;
                
                const reactionTime = Date.now() - startTime;
                
                // –°–∫—Ä—ã–≤–∞–µ–º —Ñ–∏–≥—É—Ä—É –∏ —Å—Ç–æ–ø-—Å–∏–≥–Ω–∞–ª
                square.classList.remove('visible');
                circle.classList.remove('visible');
                stopSignal.classList.remove('visible');
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –±—ã–ª –ª–∏ —Å—Ç–æ–ø-—Å–∏–≥–Ω–∞–ª
                if (stopSignalActive) {
                    // –ï—Å–ª–∏ –±—ã–ª —Å—Ç–æ–ø-—Å–∏–≥–Ω–∞–ª, –Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—Å–µ —Ä–∞–≤–Ω–æ –Ω–∞–∂–∞–ª - –æ—à–∏–±–∫–∞
                    errorCount++;
                    showFeedback("–û—à–∏–±–∫–∞! –ù–µ –Ω—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–∂–∏–º–∞—Ç—å –ø—Ä–∏ —Å—Ç–æ–ø-—Å–∏–≥–Ω–∞–ª–µ", false);
                } else {
                    // –ï—Å–ª–∏ –Ω–µ –±—ã–ª–æ —Å—Ç–æ–ø-—Å–∏–≥–Ω–∞–ª–∞, –ø—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–∞
                    if (currentShape === expectedShape) {
                        correctCount++;
                        totalTime += reactionTime;
                        showFeedback(`–ü—Ä–∞–≤–∏–ª—å–Ω–æ! –í—Ä–µ–º—è: ${reactionTime} –º—Å`, true);
                    } else {
                        errorCount++;
                        showFeedback("–û—à–∏–±–∫–∞! –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–ª–∞–≤–∏—à–∞", false);
                    }
                }
                
                updateStats();
                setTimeout(nextTrial, 1000);
            }
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å
            function showFeedback(message, isPositive) {
                feedbackEl.textContent = message;
                feedbackEl.className = 'feedback ' + (isPositive ? 'positive' : 'negative');
                feedbackEl.style.display = 'block';
            }
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
            function updateStats() {
                correctEl.textContent = correctCount;
                errorsEl.textContent = errorCount;
                
                const avgTime = correctCount > 0 ? Math.round(totalTime / correctCount) : 0;
                avgTimeEl.textContent = `${avgTime} –º—Å`;
                
                const inhibitionRate = inhibitionAttempts > 0 ? 
                    Math.round((successfulInhibitions / inhibitionAttempts) * 100) : 0;
                inhibitionEl.textContent = `${inhibitionRate}%`;
            }
            
            // –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∏–≥—Ä—ã
            function endGame() {
                gameActive = false;
                startBtn.disabled = false;
                resetBtn.disabled = false;
                
                // –°–∫—Ä—ã–≤–∞–µ–º —Ñ–∏–≥—É—Ä—ã
                square.classList.remove('visible');
                circle.classList.remove('visible');
                stopSignal.classList.remove('visible');
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
                resultsEl.style.display = 'block';
                finalCorrectEl.textContent = correctCount;
                finalErrorsEl.textContent = errorCount;
                
                const avgTime = correctCount > 0 ? Math.round(totalTime / correctCount) : 0;
                finalAvgTimeEl.textContent = `${avgTime} –º—Å`;
                
                const inhibitionRate = inhibitionAttempts > 0 ? 
                    Math.round((successfulInhibitions / inhibitionAttempts) * 100) : 0;
                finalInhibitionEl.textContent = `${inhibitionRate}%`;
            }
            
            // –ù–∞–∑–Ω–∞—á–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
            startBtn.addEventListener('click', startGame);
            resetBtn.addEventListener('click', resetGame);
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞—É–¥–∏–æ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–∏
            document.addEventListener('click', initAudio);
        });
    </script>
</body>
</html>